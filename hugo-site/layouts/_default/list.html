{{- define "main" -}}

<!-- Tag Title -->
{{- if and .Title (eq .Type "tags") -}}
<h1>#{{- .Title -}}</h1>
{{- end -}}

<!-- $pages -->
{{- $pages := union .RegularPages .Sections -}}<!---->
{{- if .IsHome -}}<!---->
{{- $pages = where site.RegularPages "Type" "in" site.Params.mainSections -}}<!---->
{{- end -}}

<!-- Articles -->
{{- $paginator := .Paginate $pages -}} {{- range $index, $page :=
$paginator.Pages -}}<!---->

<!-- Banner / Avatar -->
{{- if and $.IsHome (eq $paginator.PageNumber 1) (eq $index 0) -}}<!---->

{{- /* Banner Image */ -}}
{{- if site.Params.banner_image -}}
<div class="banner-image">
  <img
    src="{{- site.Params.banner_image | relURL -}}"
    alt="{{- site.Title -}}"
  />
</div>
{{- end -}}<!---->

{{- end -}}

<article class="post-item">
  {{- if gt .Weight 0 -}}
  <span class="featured-label">Featured</span>
  {{- end -}}
  
  {{- /* Featured Image */ -}}
  {{- if .Params.featured_image -}}
  <div class="post-featured-image">
    <img
      src="{{- .Params.featured_image | relURL -}}"
      alt="{{- .Title -}}"
    />
  </div>
  {{- end -}}
  
  <h2 class="post-title">
    <a href="{{- .Permalink -}}">{{- .Title -}}</a>
  </h2>
  <time class="post-date">{{- .Date | time.Format ":date_medium" -}}</time>
  
  {{- if .Summary -}}
  <div class="post-excerpt">
    {{- .Summary -}}
  </div>
  {{- end -}}
</article>
{{- end -}}

<!-- Pagination -->
{{- if gt $paginator.TotalPages 1 -}}
<nav class="pagination">
  {{- if $paginator.HasPrev -}}
  <a class="pagination-link" href="{{- $paginator.Prev.URL | relURL -}}"
    >← Previous</a
  >
  {{- end -}}<!---->
  {{- if $paginator.HasNext -}}
  <a class="pagination-link" href="{{- $paginator.Next.URL | relURL -}}"
    >Next →</a
  >
  {{- end -}}
</nav>
{{- end -}}<!---->

{{- end -}}
